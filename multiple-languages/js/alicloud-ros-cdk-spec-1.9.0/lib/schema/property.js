"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isTagPropertyStringMap = exports.isTagPropertyJson = exports.isTagPropertyAutoScalingGroup = exports.isTagPropertyStandard = exports.isTagProperty = exports.isTagPropertyName = exports.isUnionProperty = exports.isComplexMapProperty = exports.isPrimitiveMapProperty = exports.isMapProperty = exports.isComplexListProperty = exports.isPrimitiveListProperty = exports.isListProperty = exports.isCollectionProperty = exports.isComplexProperty = exports.isPrimitiveProperty = exports.isScalarProperty = exports.isUpdateType = exports.UpdateType = void 0;
const base_types_1 = require("./base-types");
var UpdateType;
(function (UpdateType) {
    UpdateType["Conditional"] = "Conditional";
    UpdateType["Immutable"] = "Immutable";
    UpdateType["Mutable"] = "Mutable";
})(UpdateType || (exports.UpdateType = UpdateType = {}));
function isUpdateType(str) {
    switch (str) {
        case UpdateType.Conditional:
        case UpdateType.Immutable:
        case UpdateType.Mutable:
            return true;
        default:
            return false;
    }
}
exports.isUpdateType = isUpdateType;
function isScalarProperty(prop) {
    return (isPrimitiveProperty(prop) ||
        isComplexProperty(prop) ||
        // A UnionProperty is only Scalar if it defines Types or PrimitiveTypes
        (isUnionProperty(prop) && !!(prop.Types || prop.PrimitiveTypes)));
}
exports.isScalarProperty = isScalarProperty;
function isPrimitiveProperty(prop) {
    return !!prop.PrimitiveType;
}
exports.isPrimitiveProperty = isPrimitiveProperty;
function isComplexProperty(prop) {
    const propType = prop.Type;
    return propType != null && propType !== 'Map' && propType !== 'List';
}
exports.isComplexProperty = isComplexProperty;
function isCollectionProperty(prop) {
    return (isListProperty(prop) ||
        isMapProperty(prop) ||
        // A UnionProperty is only Collection if it defines ItemTypes or PrimitiveItemTypes
        (isUnionProperty(prop) && !!(prop.ItemTypes || prop.PrimitiveItemTypes)));
}
exports.isCollectionProperty = isCollectionProperty;
function isListProperty(prop) {
    return prop.Type === 'List';
}
exports.isListProperty = isListProperty;
function isPrimitiveListProperty(prop) {
    return isListProperty(prop) && !!prop.PrimitiveItemType;
}
exports.isPrimitiveListProperty = isPrimitiveListProperty;
function isComplexListProperty(prop) {
    return isListProperty(prop) && !!prop.ItemType;
}
exports.isComplexListProperty = isComplexListProperty;
function isMapProperty(prop) {
    return prop.Type === 'Map';
}
exports.isMapProperty = isMapProperty;
function isPrimitiveMapProperty(prop) {
    return isMapProperty(prop) && !!prop.PrimitiveItemType;
}
exports.isPrimitiveMapProperty = isPrimitiveMapProperty;
function isComplexMapProperty(prop) {
    return isMapProperty(prop) && !!prop.ItemType;
}
exports.isComplexMapProperty = isComplexMapProperty;
function isUnionProperty(prop) {
    const castProp = prop;
    return !!(castProp.ItemTypes || castProp.PrimitiveTypes || castProp.Types);
}
exports.isUnionProperty = isUnionProperty;
const tagPropertyNames = {
    FileSystemTags: '',
    HostedZoneTags: '',
    Tags: '',
    UserPoolTags: '',
};
function isTagPropertyName(name) {
    if (undefined === name) {
        return false;
    }
    return tagPropertyNames.hasOwnProperty(name);
}
exports.isTagPropertyName = isTagPropertyName;
/**
 * This function validates that the property **can** be a Tag Property
 *
 * The property is only a Tag if the name of this property is Tags, which is
 * validated using `ResourceType.isTaggable(resource)`.
 */
function isTagProperty(prop) {
    return (isTagPropertyStandard(prop) ||
        isTagPropertyAutoScalingGroup(prop) ||
        isTagPropertyJson(prop) ||
        isTagPropertyStringMap(prop));
}
exports.isTagProperty = isTagProperty;
function isTagPropertyStandard(prop) {
    return (prop.ItemType === 'Tag' ||
        prop.ItemType === 'TagsEntry' ||
        prop.Type === 'Tags' ||
        prop.ItemType === 'TagRef' ||
        prop.ItemType === 'ElasticFileSystemTag' ||
        prop.ItemType === 'HostedZoneTag');
}
exports.isTagPropertyStandard = isTagPropertyStandard;
function isTagPropertyAutoScalingGroup(prop) {
    return prop.ItemType === 'TagProperty';
}
exports.isTagPropertyAutoScalingGroup = isTagPropertyAutoScalingGroup;
function isTagPropertyJson(prop) {
    return prop.PrimitiveType === base_types_1.PrimitiveType.Json;
}
exports.isTagPropertyJson = isTagPropertyJson;
function isTagPropertyStringMap(prop) {
    return prop.PrimitiveItemType === 'String';
}
exports.isTagPropertyStringMap = isTagPropertyStringMap;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJwcm9wZXJ0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBeUQ7QUF1SHpELElBQVksVUFJWDtBQUpELFdBQVksVUFBVTtJQUNwQix5Q0FBMkIsQ0FBQTtJQUMzQixxQ0FBdUIsQ0FBQTtJQUN2QixpQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBSlcsVUFBVSwwQkFBVixVQUFVLFFBSXJCO0FBRUQsU0FBZ0IsWUFBWSxDQUFDLEdBQVc7SUFDdEMsUUFBUSxHQUFHLEVBQUU7UUFDWCxLQUFLLFVBQVUsQ0FBQyxXQUFXLENBQUM7UUFDNUIsS0FBSyxVQUFVLENBQUMsU0FBUyxDQUFDO1FBQzFCLEtBQUssVUFBVSxDQUFDLE9BQU87WUFDckIsT0FBTyxJQUFJLENBQUM7UUFDZDtZQUNFLE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0FBQ0gsQ0FBQztBQVRELG9DQVNDO0FBRUQsU0FBZ0IsZ0JBQWdCLENBQUMsSUFBYztJQUM3QyxPQUFPLENBQ0wsbUJBQW1CLENBQUMsSUFBSSxDQUFDO1FBQ3pCLGlCQUFpQixDQUFDLElBQUksQ0FBQztRQUN2Qix1RUFBdUU7UUFDdkUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FDakUsQ0FBQztBQUNKLENBQUM7QUFQRCw0Q0FPQztBQUVELFNBQWdCLG1CQUFtQixDQUFDLElBQWM7SUFDaEQsT0FBTyxDQUFDLENBQUUsSUFBMEIsQ0FBQyxhQUFhLENBQUM7QUFDckQsQ0FBQztBQUZELGtEQUVDO0FBRUQsU0FBZ0IsaUJBQWlCLENBQUMsSUFBYztJQUM5QyxNQUFNLFFBQVEsR0FBSSxJQUF3QixDQUFDLElBQUksQ0FBQztJQUNoRCxPQUFPLFFBQVEsSUFBSSxJQUFJLElBQUksUUFBUSxLQUFLLEtBQUssSUFBSSxRQUFRLEtB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Q0osQ0FBQztBQVRELHNEQVNDO0FBRUQsU0FBZ0IsNkJBQTZCLENBQUMsSUFBYztJQUMxRCxPQUFRLElBQW9DLENBQUMsUUFBUSxLQUFLLGFBQWEsQ0FBQztBQUMxRSxDQUFDO0FBRkQsc0VBRUM7QUFFRCxTQUFnQixpQkFBaUIsQ0FBQyxJQUFjO0lBQzlDLE9BQVEsSUFBd0IsQ0FBQyxhQUFhLEtBQUssMEJBQWEsQ0FBQyxJQUFJLENBQUM7QUFDeEUsQ0FBQztBQUZELDhDQUVDO0FBRUQsU0FBZ0Isc0JBQXNCLENBQUMsSUFBYztJQUNuRCxPQUFRLElBQTZCLENBQUMsaUJBQWlCLEtBQUssUUFBUSxDQUFDO0FBQ3ZFLENBQUM7QUFGRCx3REFFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERvY3VtZW50ZWQsIFByaW1pdGl2ZVR5cGUgfSBmcm9tICcuL2Jhc2UtdHlwZXMnO1xuXG5leHBvcnQgdHlwZSBQcm9wZXJ0eSA9IFNjYWxhclByb3BlcnR5IHwgQ29sbGVjdGlvblByb3BlcnR5O1xuZXhwb3J0IHR5cGUgU2NhbGFyUHJvcGVydHkgPSBQcmltaXRpdmVQcm9wZXJ0eSB8IENvbXBsZXhQcm9wZXJ0eSB8IFVuaW9uUHJvcGVydHk7XG5leHBvcnQgdHlwZSBDb2xsZWN0aW9uUHJvcGVydHkgPSBMaXN0UHJvcGVydHkgfCBNYXBQcm9wZXJ0eSB8IFVuaW9uUHJvcGVydHk7XG5leHBvcnQgdHlwZSBMaXN0UHJvcGVydHkgPSBQcmltaXRpdmVMaXN0UHJvcGVydHkgfCBDb21wbGV4TGlzdFByb3BlcnR5O1xuZXhwb3J0IHR5cGUgTWFwUHJvcGVydHkgPSBQcmltaXRpdmVNYXBQcm9wZXJ0eSB8IENvbXBsZXhNYXBQcm9wZXJ0eTtcbmV4cG9ydCB0eXBlIFRhZ1Byb3BlcnR5ID0gVGFnUHJvcGVydHlTdGFuZGFyZCB8IFRhZ1Byb3BlcnR5QXV0b1NjYWxpbmdHcm91cCB8IFRhZ1Byb3BlcnR5SnNvbiB8IFRhZ1Byb3BlcnR5U3RyaW5nTWFwO1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3BlcnR5QmFzZSBleHRlbmRzIERvY3VtZW50ZWQge1xuICBDb25zdHJhaW50cz86IFtPYmplY3RdO1xuICBEZXNjcmlwdGlvbj86IHN0cmluZztcbiAgVHlwZT86IHN0cmluZztcblxuICBEZWZhdWx0PzogYW55O1xuICAvKipcbiAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHByb3BlcnR5IGlzIHJlcXVpcmVkLlxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgUmVxdWlyZWQ/OiBib29sZWFuO1xuICAvKipcbiAgICogRHVyaW5nIGEgc3RhY2sgdXBkYXRlLCB0aGUgdXBkYXRlIGJlaGF2aW9yIHdoZW4geW91IGFkZCwgcmVtb3ZlLCBvciBtb2RpZnkgdGhlIHByb3BlcnR5LiBST1NcbiAgICogcmVwbGFjZXMgdGhlIHJlc291cmNlIHdoZW4geW91IGNoYW5nZSBgw4xtbXV0YWJsZWBgcHJvcGVydGllcy4gUk9TIGRvZXNuJ3QgcmVwbGFjZSB0aGUgcmVzb3VyY2VcbiAgICogd2hlbiB5b3UgY2hhbmdlIGBgTXV0YWJsZWBgIHByb3BlcnRpZXMuIGBgQ29uZGl0aW9uYWxgYCB1cGRhdGVzIGNhbiBiZSBtdXRhYmxlIG9yIGltbXV0YWJsZSwgZGVwZW5kaW5nIG9uLCBmb3JcbiAgICogZXhhbXBsZSwgd2hpY2ggb3RoZXIgcHJvcGVydGllcyB5b3UgdXBkYXRlZC5cbiAgICpcbiAgICogQGRlZmF1bHQgVXBkYXRlVHlwZS5NdXRhYmxlXG4gICAqL1xuICBVcGRhdGVUeXBlPzogVXBkYXRlVHlwZTtcblxuICBQcmltaXRpdmVOYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJpbWl0aXZlUHJvcGVydHkgZXh0ZW5kcyBQcm9wZXJ0eUJhc2Uge1xuICAvKiogVGhlIHZhbGlkIHByaW1pdGl2ZSB0eXBlIGZvciB0aGUgcHJvcGVydHkuICovXG4gIFByaW1pdGl2ZVR5cGU6IFByaW1pdGl2ZVR5cGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGxleFByb3BlcnR5IGV4dGVuZHMgUHJvcGVydHlCYXNlIHtcbiAgLyoqIFRoZSB0eXBlIG9mIHZhbGlkIHZhbHVlcyBmb3IgdGhpcyBwcm9wZXJ0eSAqL1xuICBUeXBlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlzdFByb3BlcnR5QmFzZSBleHRlbmRzIFByb3BlcnR5QmFzZSB7XG4gIC8qKlxuICAgKiBBIGxpc3QgaXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiB2YWx1ZXMuXG4gICAqL1xuICBUeXBlOiAnTGlzdCc7XG4gIC8qKlxuICAgKiBJbmRpY2F0ZXMgd2hldGhlciBST1MgYWxsb3dzIGR1cGxpY2F0ZSB2YWx1ZXMuIElmIHRoZSB2YWx1ZSBpcyBgYHRydWVgYCwgUk9TXG4gICAqIGlnbm9yZXMgZHVwbGljYXRlIHZhbHVlcy4gaWYgdGhlIHZhbHVlIGlzICBgYGZhbHNlYGAsIFJPUyByZXR1cm5zIGFuIGFycm9yIGlmIHlvdSBzdWJtaXQgZHVwbGljYXRlXG4gICAqIHZhbHVlcy5cbiAgICovXG4gIER1cGxpY2F0ZXNBbGxvd2VkPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcmltaXRpdmVMaXN0UHJvcGVydHkgZXh0ZW5kcyBMaXN0UHJvcGVydHlCYXNlIHtcbiAgLyoqIFRoZSB2YWxpZCBwcmltaXRpdmUgdHlwZSBmb3IgdGhlIHByb3BlcnR5LiAqL1xuICBQcmltaXRpdmVJdGVtVHlwZTogUHJpbWl0aXZlVHlwZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wbGV4TGlzdFByb3BlcnR5IGV4dGVuZHMgTGlzdFByb3BlcnR5QmFzZSB7XG4gIC8qKiBWYWxpZCB2YWx1ZXMgZm9yIHRoZSBwcm9wZXJ0eSAqL1xuICBJdGVtVHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcFByb3BlcnR5QmFzZSBleHRlbmRzIFByb3BlcnR5QmFzZSB7XG4gIC8qKiBBIG1hcCBpcyBhIHNldCBvZiBrZXktdmFsdWUgcGFpcnMsIHdoZXJlIHRoZSBrZXlzIGFyZSBhbHdheXMgc3RyaW5ncy4gKi9cbiAgVHlwZTogJ01hcCc7XG4gIC8qKlxuICAgKiBJbmRpY2F0ZXMgd2hldGhlciBST1MgYWxsb3dzIGR1cGxpY2F0ZSB2YWx1ZXMuIElmIHRoZSB2YWx1ZSBpcyBgYHRydWVgYCwgUk9TXG4gICAqIGlnbm9yZXMgZHVwbGljYXRlIHZhbHVlcy4gaWYgdGhlIHZhbHVlIGlzICBgYGZhbHNlYGAsIFJPUyByZXR1cm5zIGFuIGFycm9yIGlmIHlvdSBzdWJtaXQgZHVwbGljYXRlXG4gICAqIHZhbHVlcy5cbiAgICovXG4gIER1cGxpY2F0ZXNBbGxvd2VkPzogZmFsc2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJpbWl0aXZlTWFwUHJvcGVydHkgZXh0ZW5kcyBNYXBQcm9wZXJ0eUJhc2Uge1xuICAvKiogVGhlIHZhbGlkIHByaW1pdGl2ZSB0eXBlIGZvciB0aGUgcHJvcGVydHkuICovXG4gIFByaW1pdGl2ZUl0ZW1UeXBlOiBQcmltaXRpdmVUeXBlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBsZXhNYXBQcm9wZXJ0eSBleHRlbmRzIE1hcFByb3BlcnR5QmFzZSB7XG4gIC8qKiBWYWxpZCB2YWx1ZXMgZm9yIHRoZSBwcm9wZXJ0eSAqL1xuICBJdGVtVHlwZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ1Byb3BlcnR5U3RhbmRhcmQgZXh0ZW5kcyBQcm9wZXJ0eUJhc2Uge1xuICBJdGVtVHlwZTogJ1RhZycgfCAnVGFnc0VudHJ5JyB8ICdUYWdSZWYnIHwgJ0VsYXN0aWNGaWxlU3lzdGVtVGFnJyB8ICdIb3N0ZWRab25lVGFnJztcbiAgVHlwZTogJ1RhZ3MnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ1Byb3BlcnR5QXV0b1NjYWxpbmdHcm91cCBleHRlbmRzIFByb3BlcnR5QmFzZSB7XG4gIEl0ZW1UeXBlOiAnVGFnUHJvcGVydHknO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhZ1Byb3BlcnR5SnNvbiBleHRlbmRzIFByb3BlcnR5QmFzZSB7XG4gIFByaW1pdGl2ZVR5cGU6IFByaW1pdGl2ZVR5cGUuSnNvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUYWdQcm9wZXJ0eVN0cmluZ01hcCBleHRlbmRzIFByb3BlcnR5QmFzZSB7XG4gIFByaW1pdGl2ZUl0ZW1UeXBlOiAnU3RyaW5nJztcbn1cblxuLyoqXG4gKiBBIHByb3BlcnR5IHR5cGUgdGhhdCBjYW4gYmUgb25lIG9mIHNldmVyYWwgdHlwZXMuIEN1cnJlbnRseSB1c2VkIG9ubHkgaW4gU0FNLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVuaW9uUHJvcGVydHkgZXh0ZW5kcyBQcm9wZXJ0eUJhc2Uge1xuICAvKiogVmFsaWQgcHJpbWl0aXZlIHR5cGVzIGZvciB0aGUgcHJvcGVydHkgKi9cbiAgUHJpbWl0aXZlVHlwZXM/OiBQcmltaXRpdmVUeXBlW107XG4gIC8qKiBWYWxpZCBjb21wbGV4IHR5cGVzIGZvciB0aGUgcHJvcGVydHkgKi9cbiAgVHlwZXM/OiBzdHJpbmdbXTtcbiAgLyoqIFZhbGlkIHByaW1pdGl2ZSBpdGVtIHR5cGVzIGZvciB0aGlzIHByb3BlcnR5ICovXG4gIFByaW1pdGl2ZUl0ZW1UeXBlcz86IFByaW1pdGl2ZVR5cGVbXTtcbiAgLyoqIFZhbGlkIGxpc3QgaXRlbSB0eXBlcyBmb3IgdGhlIHByb3BlcnR5ICovXG4gIEl0ZW1UeXBlcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgZW51bSBVcGRhdGVUeXBlIHtcbiAgQ29uZGl0aW9uYWwgPSAnQ29uZGl0aW9uYWwnLFxuICBJbW11dGFibGUgPSAnSW1tdXRhYmxlJyxcbiAgTXV0YWJsZSA9ICdNdXRhYmxlJyxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVXBkYXRlVHlwZShzdHI6IHN0cmluZyk6IHN0ciBpcyBVcGRhdGVUeXBlIHtcbiAgc3dpdGNoIChzdHIpIHtcbiAgICBjYXNlIFVwZGF0ZVR5cGUuQ29uZGl0aW9uYWw6XG4gICAgY2FzZSBVcGRhdGVUeXBlLkltbXV0YWJsZTpcbiAgICBjYXNlIFVwZGF0ZVR5cGUuTXV0YWJsZTpcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2NhbGFyUHJvcGVydHkocHJvcDogUHJvcGVydHkpOiBwcm9wIGlzIFNjYWxhclByb3BlcnR5IHtcbiAgcmV0dXJuIChcbiAgICBpc1ByaW1pdGl2ZVByb3BlcnR5KHByb3ApIHx8XG4gICAgaXNDb21wbGV4UHJvcGVydHkocHJvcCkgfHxcbiAgICAvLyBBIFVuaW9uUHJvcGVydHkgaXMgb25seSBTY2FsYXIgaWYgaXQgZGVmaW5lcyBUeXBlcyBvciBQcmltaXRpdmVUeXBlc1xuICAgIChpc1VuaW9uUHJvcGVydHkocHJvcCkgJiYgISEocHJvcC5UeXBlcyB8fCBwcm9wLlByaW1pdGl2ZVR5cGVzKSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJpbWl0aXZlUHJvcGVydHkocHJvcDogUHJvcGVydHkpOiBwcm9wIGlzIFByaW1pdGl2ZVByb3BlcnR5IHtcbiAgcmV0dXJuICEhKHByb3AgYXMgUHJpbWl0aXZlUHJvcGVydHkpLlByaW1pdGl2ZVR5cGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbXBsZXhQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSk6IHByb3AgaXMgQ29tcGxleFByb3BlcnR5IHtcbiAgY29uc3QgcHJvcFR5cGUgPSAocHJvcCBhcyBDb21wbGV4UHJvcGVydHkpLlR5cGU7XG4gIHJldHVybiBwcm9wVHlwZSAhPSBudWxsICYmIHByb3BUeXBlICE9PSAnTWFwJyAmJiBwcm9wVHlwZSAhPT0gJ0xpc3QnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDb2xsZWN0aW9uUHJvcGVydHkocHJvcDogUHJvcGVydHkpOiBwcm9wIGlzIENvbGxlY3Rpb25Qcm9wZXJ0eSB7XG4gIHJldHVybiAoXG4gICAgaXNMaXN0UHJvcGVydHkocHJvcCkgfHxcbiAgICBpc01hcFByb3BlcnR5KHByb3ApIHx8XG4gICAgLy8gQSBVbmlvblByb3BlcnR5IGlzIG9ubHkgQ29sbGVjdGlvbiBpZiBpdCBkZWZpbmVzIEl0ZW1UeXBlcyBvciBQcmltaXRpdmVJdGVtVHlwZXNcbiAgICAoaXNVbmlvblByb3BlcnR5KHByb3ApICYmICEhKHByb3AuSXRlbVR5cGVzIHx8IHByb3AuUHJpbWl0aXZlSXRlbVR5cGVzKSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTGlzdFByb3BlcnR5KHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBMaXN0UHJvcGVydHkge1xuICByZXR1cm4gKHByb3AgYXMgTGlzdFByb3BlcnR5KS5UeXBlID09PSAnTGlzdCc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ByaW1pdGl2ZUxpc3RQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSk6IHByb3AgaXMgUHJpbWl0aXZlTGlzdFByb3BlcnR5IHtcbiAgcmV0dXJuIGlzTGlzdFByb3BlcnR5KHByb3ApICYmICEhKHByb3AgYXMgUHJpbWl0aXZlTGlzdFByb3BlcnR5KS5QcmltaXRpdmVJdGVtVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcGxleExpc3RQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSk6IHByb3AgaXMgQ29tcGxleExpc3RQcm9wZXJ0eSB7XG4gIHJldHVybiBpc0xpc3RQcm9wZXJ0eShwcm9wKSAmJiAhIShwcm9wIGFzIENvbXBsZXhMaXN0UHJvcGVydHkpLkl0ZW1UeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNNYXBQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSk6IHByb3AgaXMgTWFwUHJvcGVydHkge1xuICByZXR1cm4gKHByb3AgYXMgTWFwUHJvcGVydHkpLlR5cGUgPT09ICdNYXAnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQcmltaXRpdmVNYXBQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSk6IHByb3AgaXMgUHJpbWl0aXZlTWFwUHJvcGVydHkge1xuICByZXR1cm4gaXNNYXBQcm9wZXJ0eShwcm9wKSAmJiAhIShwcm9wIGFzIFByaW1pdGl2ZU1hcFByb3BlcnR5KS5QcmltaXRpdmVJdGVtVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcGxleE1hcFByb3BlcnR5KHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBDb21wbGV4TWFwUHJvcGVydHkge1xuICByZXR1cm4gaXNNYXBQcm9wZXJ0eShwcm9wKSAmJiAhIShwcm9wIGFzIENvbXBsZXhNYXBQcm9wZXJ0eSkuSXRlbVR5cGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1VuaW9uUHJvcGVydHkocHJvcDogUHJvcGVydHkpOiBwcm9wIGlzIFVuaW9uUHJvcGVydHkge1xuICBjb25zdCBjYXN0UHJvcCA9IHByb3AgYXMgVW5pb25Qcm9wZXJ0eTtcbiAgcmV0dXJuICEhKGNhc3RQcm9wLkl0ZW1UeXBlcyB8fCBjYXN0UHJvcC5QcmltaXRpdmVUeXBlcyB8fCBjYXN0UHJvcC5UeXBlcyk7XG59XG5cbmNvbnN0IHRhZ1Byb3BlcnR5TmFtZXMgPSB7XG4gIEZpbGVTeXN0ZW1UYWdzOiAnJyxcbiAgSG9zdGVkWm9uZVRhZ3M6ICcnLFxuICBUYWdzOiAnJyxcbiAgVXNlclBvb2xUYWdzOiAnJyxcbn07XG5cbmV4cG9ydCB0eXBlIFRhZ1Byb3BlcnR5TmFtZSA9IGtleW9mIHR5cGVvZiB0YWdQcm9wZXJ0eU5hbWVzO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNUYWdQcm9wZXJ0eU5hbWUobmFtZT86IHN0cmluZyk6IG5hbWUgaXMgVGFnUHJvcGVydHlOYW1lIHtcbiAgaWYgKHVuZGVmaW5lZCA9PT0gbmFtZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdGFnUHJvcGVydHlOYW1lcy5oYXNPd25Qcm9wZXJ0eShuYW1lKTtcbn1cbi8qKlxuICogVGhpcyBmdW5jdGlvbiB2YWxpZGF0ZXMgdGhhdCB0aGUgcHJvcGVydHkgKipjYW4qKiBiZSBhIFRhZyBQcm9wZXJ0eVxuICpcbiAqIFRoZSBwcm9wZXJ0eSBpcyBvbmx5IGEgVGFnIGlmIHRoZSBuYW1lIG9mIHRoaXMgcHJvcGVydHkgaXMgVGFncywgd2hpY2ggaXNcbiAqIHZhbGlkYXRlZCB1c2luZyBgUmVzb3VyY2VUeXBlLmlzVGFnZ2FibGUocmVzb3VyY2UpYC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnUHJvcGVydHkocHJvcDogUHJvcGVydHkpOiBwcm9wIGlzIFRhZ1Byb3BlcnR5IHtcbiAgcmV0dXJuIChcbiAgICBpc1RhZ1Byb3BlcnR5U3RhbmRhcmQocHJvcCkgfHxcbiAgICBpc1RhZ1Byb3BlcnR5QXV0b1NjYWxpbmdHcm91cChwcm9wKSB8fFxuICAgIGlzVGFnUHJvcGVydHlKc29uKHByb3ApIHx8XG4gICAgaXNUYWdQcm9wZXJ0eVN0cmluZ01hcChwcm9wKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNUYWdQcm9wZXJ0eVN0YW5kYXJkKHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBUYWdQcm9wZXJ0eVN0YW5kYXJkIHtcbiAgcmV0dXJuIChcbiAgICAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0YW5kYXJkKS5JdGVtVHlwZSA9PT0gJ1RhZycgfHxcbiAgICAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0YW5kYXJkKS5JdGVtVHlwZSA9PT0gJ1RhZ3NFbnRyeScgfHxcbiAgICAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0YW5kYXJkKS5UeXBlID09PSAnVGFncycgfHxcbiAgICAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0YW5kYXJkKS5JdGVtVHlwZSA9PT0gJ1RhZ1JlZicgfHxcbiAgICAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0YW5kYXJkKS5JdGVtVHlwZSA9PT0gJ0VsYXN0aWNGaWxlU3lzdGVtVGFnJyB8fFxuICAgIChwcm9wIGFzIFRhZ1Byb3BlcnR5U3RhbmRhcmQpLkl0ZW1UeXBlID09PSAnSG9zdGVkWm9uZVRhZydcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnUHJvcGVydHlBdXRvU2NhbGluZ0dyb3VwKHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBUYWdQcm9wZXJ0eUF1dG9TY2FsaW5nR3JvdXAge1xuICByZXR1cm4gKHByb3AgYXMgVGFnUHJvcGVydHlBdXRvU2NhbGluZ0dyb3VwKS5JdGVtVHlwZSA9PT0gJ1RhZ1Byb3BlcnR5Jztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnUHJvcGVydHlKc29uKHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBUYWdQcm9wZXJ0eUpzb24ge1xuICByZXR1cm4gKHByb3AgYXMgVGFnUHJvcGVydHlKc29uKS5QcmltaXRpdmVUeXBlID09PSBQcmltaXRpdmVUeXBlLkpzb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RhZ1Byb3BlcnR5U3RyaW5nTWFwKHByb3A6IFByb3BlcnR5KTogcHJvcCBpcyBUYWdQcm9wZXJ0eVN0cmluZ01hcCB7XG4gIHJldHVybiAocHJvcCBhcyBUYWdQcm9wZXJ0eVN0cmluZ01hcCkuUHJpbWl0aXZlSXRlbVR5cGUgPT09ICdTdHJpbmcnO1xufVxuIl19